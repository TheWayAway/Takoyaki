<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline - Takoyaki</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <div class="header-left">
            <h1>Takoyaki Timeline</h1>
            <% if (isSuperAdmin) { %>
                <span class="admin-badge">Super Admin</span>
            <% } %>
        </div>
        <div class="header-right">
            <% if (isSuperAdmin) { %>
                <button id="edit-mode-btn" class="edit-mode-btn">Enable Edit Mode</button>
            <% } %>
            <a href="/logout" class="logout-btn">Logout</a>
        </div>
    </header>

    <main class="timeline-container">
        <% if (events.length === 0) { %>
            <p class="no-events">No events recorded yet.</p>
        <% } else { %>
            <div class="timeline">
                <% events.forEach(event => { %>
                    <div class="timeline-event" data-event-id="<%= event.id %>">
                        <div class="event-date"><%= event.event_date %></div>
                        <div class="event-content">
                            <div class="event-header">
                                <h3 class="event-title"><%= event.title %></h3>
                                <span class="event-id hidden">ID: <%= event.id %></span>
                            </div>
                            <% if (event.description) { %>
                                <p class="event-description"><%= event.description %></p>
                            <% } %>
                            <div class="event-actions hidden">
                                <button class="btn-edit" data-id="<%= event.id %>">Edit</button>
                                <button class="btn-delete" data-id="<%= event.id %>">Delete</button>
                            </div>
                        </div>
                    </div>
                <% }); %>
            </div>
        <% } %>
    </main>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <h2>Edit Event</h2>
            <form id="edit-form">
                <input type="hidden" id="edit-id" name="id">
                <div class="form-group">
                    <label for="edit-date">Date</label>
                    <input type="date" id="edit-date" name="eventDate" required>
                </div>
                <div class="form-group">
                    <label for="edit-title">Title</label>
                    <input type="text" id="edit-title" name="title" required>
                </div>
                <div class="form-group">
                    <label for="edit-description">Description</label>
                    <textarea id="edit-description" name="description" rows="4"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" id="edit-cancel">Cancel</button>
                    <button type="submit" class="btn-save">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <h2>Confirm Delete</h2>
            <p>Are you sure you want to delete this event?</p>
            <p class="delete-event-title"></p>
            <input type="hidden" id="delete-id">
            <div class="modal-actions">
                <button type="button" class="btn-cancel" id="delete-cancel">Cancel</button>
                <button type="button" class="btn-delete-confirm" id="delete-confirm">Delete</button>
            </div>
        </div>
    </div>

    <% if (isSuperAdmin) { %>
        <script src="/js/timeline.js"></script>
    <% } %>
</body>
</html>
